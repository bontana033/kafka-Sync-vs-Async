[2022-12-17 20:00:01,642] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition library-events-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:00:01,643] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition library-events-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:00:01,644] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition library-events-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:00:01,644] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 20:00:01,645] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 20:00:18,789] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2022-12-17 20:00:18,800] INFO [Controller id=0 epoch=5] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 20:00:18,801] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2022-12-17 20:00:18,806] INFO [Controller id=0 epoch=5] Partition library-events-1 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:00:18,806] INFO [Controller id=0 epoch=5] Partition library-events-0 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:00:18,807] INFO [Controller id=0 epoch=5] Partition library-events-2 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:00:18,824] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:00:18,834] INFO [Controller id=0 epoch=5] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:00:18,834] INFO [Controller id=0 epoch=5] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:00:18,835] INFO [Controller id=0 epoch=5] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:00:18,835] INFO [Controller id=0 epoch=5] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 20:00:18,835] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2022-12-17 20:00:18,846] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition library-events-2 (last update controller epoch 2) but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2022-12-17 20:00:18,847] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition library-events-0 (last update controller epoch 2) but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2022-12-17 20:00:18,847] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition library-events-1 (last update controller epoch 2) but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2022-12-17 20:00:18,848] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:00:18,848] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 5 with correlation id 1 for 0 partitions (state.change.logger)
[2022-12-17 20:00:18,849] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:00:18,849] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:00:18,849] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 20:00:18,852] INFO [Broker id=0] Finished LeaderAndIsr request in 29ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:00:18,872] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 2 (state.change.logger)
[2022-12-17 20:00:18,888] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:00:18,889] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 5 for partition library-events-2 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:00:18,889] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 5 for partition library-events-0 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:00:18,889] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 5 for partition library-events-1 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:00:18,889] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 5 with correlation id 3 for 0 partitions (state.change.logger)
[2022-12-17 20:00:18,889] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:00:18,890] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 4 (state.change.logger)
[2022-12-17 20:03:22,326] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 20:03:22,327] INFO [Controller id=0 epoch=5] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2022-12-17 20:03:22,330] INFO [Broker id=0] Handling StopReplica request correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:03:22,333] INFO [Controller id=0 epoch=5] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:03:22,333] INFO [Controller id=0 epoch=5] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:03:22,333] INFO [Controller id=0 epoch=5] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:03:22,334] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2022-12-17 20:03:22,334] INFO [Controller id=0 epoch=5] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2022-12-17 20:03:22,339] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 6 (state.change.logger)
[2022-12-17 20:03:22,341] INFO [Broker id=0] Handling StopReplica request correlationId 7 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:06:23,889] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2022-12-17 20:06:23,904] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 20:06:23,905] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2022-12-17 20:06:23,913] INFO [Controller id=0 epoch=6] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:6) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:06:23,913] INFO [Controller id=0 epoch=6] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:6) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:06:23,913] INFO [Controller id=0 epoch=6] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:6) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:06:23,931] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:06:23,937] INFO [Controller id=0 epoch=6] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:06:23,937] INFO [Controller id=0 epoch=6] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:06:23,937] INFO [Controller id=0 epoch=6] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 20:06:23,937] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 20:06:23,937] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2022-12-17 20:06:23,950] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 6 for partition library-events-2 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:06:23,951] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 6 for partition library-events-0 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:06:23,952] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 6 for partition library-events-1 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:06:23,952] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 6 with correlation id 1 for 0 partitions (state.change.logger)
[2022-12-17 20:06:23,955] ERROR [Controller id=0 epoch=6] Controller 0 epoch 6 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:06:23,956] INFO [Broker id=0] Finished LeaderAndIsr request in 26ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:06:23,973] ERROR [Controller id=0 epoch=6] Controller 0 epoch 6 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:06:23,973] ERROR [Controller id=0 epoch=6] Controller 0 epoch 6 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:06:23,973] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 20:06:23,978] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 2 (state.change.logger)
[2022-12-17 20:06:23,979] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:06:23,979] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 6 for partition library-events-2 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:06:23,979] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 6 for partition library-events-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:06:23,979] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 6 for partition library-events-1 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:06:23,979] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 6 with correlation id 3 for 0 partitions (state.change.logger)
[2022-12-17 20:06:23,980] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:06:23,981] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 4 (state.change.logger)
[2022-12-17 20:06:52,932] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2022-12-17 20:06:52,933] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(1) for 3 partitions (state.change.logger)
[2022-12-17 20:06:52,935] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 20:06:52,949] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0, 1) for 3 partitions (state.change.logger)
[2022-12-17 20:06:52,951] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 6 (state.change.logger)
[2022-12-17 20:06:52,955] ERROR [Controller id=0 epoch=6] Controller 0 epoch 6 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:06:52,955] ERROR [Controller id=0 epoch=6] Controller 0 epoch 6 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:06:52,956] ERROR [Controller id=0 epoch=6] Controller 0 epoch 6 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 20:06:52,956] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 20:06:53,042] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 0 (state.change.logger)
[2022-12-17 20:06:53,055] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:06:53,064] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 6 for partition library-events-2 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:06:53,066] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 6 for partition library-events-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:06:53,066] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 6 for partition library-events-1 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:06:53,066] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 6 with correlation id 1 for 0 partitions (state.change.logger)
[2022-12-17 20:06:53,070] INFO [Broker id=1] Finished LeaderAndIsr request in 15ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:06:53,072] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 2 (state.change.logger)
[2022-12-17 20:07:12,949] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0, 1) for 0 partitions (state.change.logger)
[2022-12-17 20:07:12,950] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(2) for 3 partitions (state.change.logger)
[2022-12-17 20:07:12,950] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 20:07:12,950] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 3 partitions (state.change.logger)
[2022-12-17 20:07:12,952] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 8 (state.change.logger)
[2022-12-17 20:07:12,954] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 4 (state.change.logger)
[2022-12-17 20:07:13,006] INFO [Controller id=0 epoch=6] Changed partition library-events-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, partitionEpoch=9) (state.change.logger)
[2022-12-17 20:07:13,006] INFO [Controller id=0 epoch=6] Changed partition library-events-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, partitionEpoch=9) (state.change.logger)
[2022-12-17 20:07:13,006] INFO [Controller id=0 epoch=6] Changed partition library-events-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, partitionEpoch=9) (state.change.logger)
[2022-12-17 20:07:13,006] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 2 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 20:07:13,007] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 20:07:13,007] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 20:07:13,007] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,008] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,008] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,013] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 7 from offset 0 with partition epoch 9 and high watermark 0. Current leader is 2. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 20:07:13,014] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 7 from offset 0 with partition epoch 9 and high watermark 0. Current leader is 2. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 20:07:13,014] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 7 from offset 0 with partition epoch 9 and high watermark 0. Current leader is 2. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 20:07:13,016] INFO [Broker id=0] Follower library-events-2 starts at leader epoch 7 from offset 0 with partition epoch 9 and high watermark 0. Current leader is 2. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 20:07:13,016] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 7 from offset 0 with partition epoch 9 and high watermark 0. Current leader is 2. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 20:07:13,016] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 6 with correlation id 5 for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,016] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 7 from offset 0 with partition epoch 9 and high watermark 0. Current leader is 2. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 20:07:13,017] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 6 with correlation id 9 for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,044] INFO [Broker id=0] Finished LeaderAndIsr request in 36ms correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,050] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 10 (state.change.logger)
[2022-12-17 20:07:13,058] INFO [Broker id=1] Finished LeaderAndIsr request in 50ms correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,061] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 6 (state.change.logger)
[2022-12-17 20:07:13,139] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 0 (state.change.logger)
[2022-12-17 20:07:13,151] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,166] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 6 for partition library-events-2 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:07:13,169] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 6 for partition library-events-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:07:13,169] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 6 for partition library-events-1 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-12-17 20:07:13,170] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 6 with correlation id 1 for 0 partitions (state.change.logger)
[2022-12-17 20:07:13,173] INFO [Broker id=2] Finished LeaderAndIsr request in 23ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,201] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 2 (state.change.logger)
[2022-12-17 20:07:13,203] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,205] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 6 as part of the become-leader transition for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,210] INFO [Broker id=2] Leader library-events-2 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 7 from offset 0 with partition epoch 9, high watermark 0, ISR [2], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 20:07:13,233] INFO [Broker id=2] Leader library-events-0 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 7 from offset 0 with partition epoch 9, high watermark 0, ISR [2], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 20:07:13,252] INFO [Broker id=2] Leader library-events-1 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 7 from offset 0 with partition epoch 9, high watermark 0, ISR [2], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 20:07:13,272] INFO [Broker id=2] Finished LeaderAndIsr request in 69ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 20:07:13,273] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 4 (state.change.logger)
[2022-12-17 20:07:14,223] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 1 partitions (state.change.logger)
[2022-12-17 20:07:14,225] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 11 (state.change.logger)
[2022-12-17 20:07:14,225] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 5 (state.change.logger)
[2022-12-17 20:07:14,225] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 7 (state.change.logger)
[2022-12-17 20:07:14,253] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 2 partitions (state.change.logger)
[2022-12-17 20:07:14,254] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 12 (state.change.logger)
[2022-12-17 20:07:14,255] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 8 (state.change.logger)
[2022-12-17 20:07:14,255] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 6 (state.change.logger)
[2022-12-17 20:07:14,740] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 1 partitions (state.change.logger)
[2022-12-17 20:07:14,742] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 13 (state.change.logger)
[2022-12-17 20:07:14,742] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 7 (state.change.logger)
[2022-12-17 20:07:14,743] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 9 (state.change.logger)
[2022-12-17 20:07:14,764] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 2 partitions (state.change.logger)
[2022-12-17 20:07:14,765] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 14 (state.change.logger)
[2022-12-17 20:07:14,766] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 8 (state.change.logger)
[2022-12-17 20:07:14,766] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 10 (state.change.logger)
[2022-12-17 20:11:29,050] INFO [Controller id=0 epoch=6] Changed partition library-events-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(2, 1, 0), leaderRecoveryState=RECOVERED, partitionEpoch=12) (state.change.logger)
[2022-12-17 20:11:29,050] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-12-17 20:11:29,051] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-12-17 20:11:29,051] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 20:11:29,051] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,052] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,052] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,056] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,057] INFO [Broker id=2] Follower library-events-2 starts at leader epoch 8 from offset 0 with partition epoch 12 and high watermark 0. Current leader is 0. Previous leader epoch was 7. (state.change.logger)
[2022-12-17 20:11:29,057] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 8 from offset 0 with partition epoch 12 and high watermark 0. Current leader is 0. Previous leader epoch was 7. (state.change.logger)
[2022-12-17 20:11:29,058] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 6 with correlation id 9 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,058] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 15 from controller 0 epoch 6 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,073] INFO [Broker id=0] Leader library-events-2 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 8 from offset 0 with partition epoch 12, high watermark 0, ISR [2,1,0], adding replicas [] and removing replicas []. Previous leader epoch was 7. (state.change.logger)
[2022-12-17 20:11:29,077] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 6 with correlation id 11 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,079] INFO [Controller id=0 epoch=6] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=8, isr=List(2, 0, 1), leaderRecoveryState=RECOVERED, partitionEpoch=12) (state.change.logger)
[2022-12-17 20:11:29,079] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-12-17 20:11:29,080] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 20:11:29,080] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-12-17 20:11:29,080] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,086] INFO [Broker id=1] Finished LeaderAndIsr request in 30ms correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,088] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 12 (state.change.logger)
[2022-12-17 20:11:29,089] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 13 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,106] INFO [Broker id=2] Finished LeaderAndIsr request in 54ms correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,107] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 13 from controller 0 epoch 6 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,107] INFO [Broker id=0] Finished LeaderAndIsr request in 56ms correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,108] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 10 (state.change.logger)
[2022-12-17 20:11:29,109] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 16 (state.change.logger)
[2022-12-17 20:11:29,109] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,110] INFO [Broker id=2] Follower library-events-1 starts at leader epoch 8 from offset 0 with partition epoch 12 and high watermark 0. Current leader is 1. Previous leader epoch was 7. (state.change.logger)
[2022-12-17 20:11:29,110] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,110] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 8 from offset 0 with partition epoch 12 and high watermark 0. Current leader is 1. Previous leader epoch was 7. (state.change.logger)
[2022-12-17 20:11:29,111] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 6 with correlation id 17 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,111] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 6 with correlation id 11 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,115] INFO [Broker id=2] Finished LeaderAndIsr request in 6ms correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,116] INFO [Broker id=0] Finished LeaderAndIsr request in 6ms correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,120] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 18 (state.change.logger)
[2022-12-17 20:11:29,120] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 12 (state.change.logger)
[2022-12-17 20:11:29,121] INFO [Broker id=1] Leader library-events-1 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 8 from offset 0 with partition epoch 12, high watermark 0, ISR [2,0,1], adding replicas [] and removing replicas []. Previous leader epoch was 7. (state.change.logger)
[2022-12-17 20:11:29,143] INFO [Broker id=1] Finished LeaderAndIsr request in 54ms correlationId 13 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 20:11:29,145] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 14 (state.change.logger)
