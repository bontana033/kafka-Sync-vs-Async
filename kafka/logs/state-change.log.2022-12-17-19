[2022-12-17 19:41:06,708] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:41:06,729] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-12-17 19:41:06,842] INFO [Broker id=2] Leader library-events-0 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2,1,0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:41:07,040] INFO [Broker id=2] Follower library-events-2 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:41:07,061] INFO [Broker id=2] Follower library-events-1 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:41:07,062] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 1 with correlation id 1 for 2 partitions (state.change.logger)
[2022-12-17 19:41:07,166] INFO [Broker id=2] Finished LeaderAndIsr request in 460ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:41:07,192] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 2 (state.change.logger)
[2022-12-17 19:56:47,022] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 19:56:47,023] INFO [Broker id=2] Follower library-events-0 starts at leader epoch 1 from offset 0 with partition epoch 1 and high watermark 0. Current leader is 1. Previous leader epoch was 0. (state.change.logger)
[2022-12-17 19:56:47,024] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 1 with correlation id 3 for 1 partitions (state.change.logger)
[2022-12-17 19:56:47,032] INFO [Broker id=2] Finished LeaderAndIsr request in 10ms correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 19:56:47,051] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 4 (state.change.logger)
[2022-12-17 19:56:47,065] INFO [Broker id=2] Handling StopReplica request correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2022-12-17 19:56:47,066] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 5 epoch 1 for partition library-events-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-12-17 19:56:47,082] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 5 epoch 1 for partition library-events-2 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-12-17 19:56:47,087] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 6 (state.change.logger)
[2022-12-17 19:56:47,103] INFO [Broker id=2] Handling StopReplica request correlationId 7 from controller 0 for 2 partitions (state.change.logger)
[2022-12-17 19:56:47,103] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 7 epoch 1 for partition library-events-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-12-17 19:56:47,121] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 7 epoch 1 for partition library-events-2 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-12-17 19:58:31,055] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2022-12-17 19:58:31,072] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 19:58:31,073] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2022-12-17 19:58:31,079] INFO [Controller id=0 epoch=2] Partition library-events-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:58:31,079] INFO [Controller id=0 epoch=2] Partition library-events-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:58:31,079] INFO [Controller id=0 epoch=2] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:58:31,083] INFO [Controller id=0 epoch=2] Partition library-events-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:58:31,084] INFO [Controller id=0 epoch=2] Partition library-events-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:58:31,084] INFO [Controller id=0 epoch=2] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:58:31,084] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 19:58:31,084] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2022-12-17 19:58:31,116] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:58:31,127] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 2 as part of the become-leader transition for 3 partitions (state.change.logger)
[2022-12-17 19:58:31,132] INFO [Broker id=0] Leader library-events-2 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:58:31,154] INFO [Broker id=0] Leader library-events-0 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:58:31,173] INFO [Broker id=0] Leader library-events-1 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:58:31,194] INFO [Broker id=0] Finished LeaderAndIsr request in 80ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:58:31,198] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 2 (state.change.logger)
[2022-12-17 19:58:31,213] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:58:31,214] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 2 for partition library-events-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-12-17 19:58:31,215] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 2 for partition library-events-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-12-17 19:58:31,215] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 2 for partition library-events-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-12-17 19:58:31,215] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:58:31,217] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 4 (state.change.logger)
[2022-12-17 19:58:43,885] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2022-12-17 19:58:43,886] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(1) for 3 partitions (state.change.logger)
[2022-12-17 19:58:43,888] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 19:58:43,904] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0, 1) for 3 partitions (state.change.logger)
[2022-12-17 19:58:43,906] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 6 (state.change.logger)
[2022-12-17 19:58:44,002] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 0 (state.change.logger)
[2022-12-17 19:58:44,015] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:58:44,027] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 2 from offset 0 with partition epoch 2 and high watermark 0. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:58:44,027] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 2 from offset 0 with partition epoch 2 and high watermark 0. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:58:44,027] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 2 from offset 0 with partition epoch 2 and high watermark 0. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:58:44,028] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 1 for 3 partitions (state.change.logger)
[2022-12-17 19:58:44,045] INFO [Broker id=1] Finished LeaderAndIsr request in 31ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:58:44,059] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 2 (state.change.logger)
[2022-12-17 19:58:44,088] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0, 1) for 1 partitions (state.change.logger)
[2022-12-17 19:58:44,089] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 7 (state.change.logger)
[2022-12-17 19:58:44,089] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 3 (state.change.logger)
[2022-12-17 19:58:44,114] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0, 1) for 2 partitions (state.change.logger)
[2022-12-17 19:58:44,115] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 8 (state.change.logger)
[2022-12-17 19:58:44,115] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 4 (state.change.logger)
[2022-12-17 19:58:54,871] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0, 1) for 0 partitions (state.change.logger)
[2022-12-17 19:58:54,872] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(2) for 3 partitions (state.change.logger)
[2022-12-17 19:58:54,873] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 19:58:54,873] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 3 partitions (state.change.logger)
[2022-12-17 19:58:54,875] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 6 (state.change.logger)
[2022-12-17 19:58:54,875] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 10 (state.change.logger)
[2022-12-17 19:58:54,990] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 0 (state.change.logger)
[2022-12-17 19:58:55,002] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:58:55,015] INFO [Broker id=2] Follower library-events-2 starts at leader epoch 2 from offset 0 with partition epoch 3 and high watermark 0. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:58:55,015] INFO [Broker id=2] Follower library-events-0 starts at leader epoch 2 from offset 0 with partition epoch 3 and high watermark 0. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:58:55,015] INFO [Broker id=2] Follower library-events-1 starts at leader epoch 2 from offset 0 with partition epoch 3 and high watermark 0. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2022-12-17 19:58:55,016] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 1 for 3 partitions (state.change.logger)
[2022-12-17 19:58:55,032] INFO [Broker id=2] Finished LeaderAndIsr request in 29ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:58:55,068] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 1 partitions (state.change.logger)
[2022-12-17 19:58:55,069] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 11 (state.change.logger)
[2022-12-17 19:58:55,070] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 7 (state.change.logger)
[2022-12-17 19:58:55,070] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 2 (state.change.logger)
[2022-12-17 19:58:55,074] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 3 (state.change.logger)
[2022-12-17 19:58:55,109] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 2 partitions (state.change.logger)
[2022-12-17 19:58:55,109] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 12 (state.change.logger)
[2022-12-17 19:58:55,110] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 4 (state.change.logger)
[2022-12-17 19:58:55,110] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 8 (state.change.logger)
[2022-12-17 19:59:51,509] INFO [Controller id=0 epoch=2] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=3, isr=List(1, 2), leaderRecoveryState=RECOVERED, partitionEpoch=5) (state.change.logger)
[2022-12-17 19:59:51,509] INFO [Controller id=0 epoch=2] Changed partition library-events-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=3, isr=List(1, 2), leaderRecoveryState=RECOVERED, partitionEpoch=5) (state.change.logger)
[2022-12-17 19:59:51,509] INFO [Controller id=0 epoch=2] Changed partition library-events-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=3, isr=List(1, 2), leaderRecoveryState=RECOVERED, partitionEpoch=5) (state.change.logger)
[2022-12-17 19:59:51,509] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 2 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,509] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,509] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,510] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,510] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 19:59:51,510] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 13 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,510] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,511] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,512] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 9 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-12-17 19:59:51,513] INFO [Broker id=0] Follower library-events-2 starts at leader epoch 3 from offset 0 with partition epoch 5 and high watermark 0. Current leader is 2. Previous leader epoch was 2. (state.change.logger)
[2022-12-17 19:59:51,513] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 3 from offset 0 with partition epoch 5 and high watermark 0. Current leader is 2. Previous leader epoch was 2. (state.change.logger)
[2022-12-17 19:59:51,513] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 3 from offset 0 with partition epoch 5 and high watermark 0. Current leader is 1. Previous leader epoch was 2. (state.change.logger)
[2022-12-17 19:59:51,513] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 2 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-12-17 19:59:51,513] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 13 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,516] INFO [Broker id=1] Leader library-events-1 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 3 from offset 0 with partition epoch 5, high watermark 0, ISR [1,2], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2022-12-17 19:59:51,518] INFO [Broker id=2] Leader library-events-2 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 3 from offset 0 with partition epoch 5, high watermark 0, ISR [1,2], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2022-12-17 19:59:51,522] INFO [Broker id=0] Finished LeaderAndIsr request in 12ms correlationId 13 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,555] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 3 from offset 0 with partition epoch 5 and high watermark 0. Current leader is 2. Previous leader epoch was 2. (state.change.logger)
[2022-12-17 19:59:51,571] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 3 from offset 0 with partition epoch 5 and high watermark 0. Current leader is 2. Previous leader epoch was 2. (state.change.logger)
[2022-12-17 19:59:51,573] INFO [Controller id=0 epoch=2] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2022-12-17 19:59:51,589] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,589] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,589] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,589] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 1 partitions (state.change.logger)
[2022-12-17 19:59:51,589] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 19:59:51,590] INFO [Controller id=0 epoch=2] Sending StopReplica request for 2 replicas to broker 1 (state.change.logger)
[2022-12-17 19:59:51,593] INFO [Broker id=2] Leader library-events-0 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 3 from offset 0 with partition epoch 5, high watermark 0, ISR [1,2], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2022-12-17 19:59:51,628] INFO [Broker id=2] Follower library-events-1 starts at leader epoch 3 from offset 0 with partition epoch 5 and high watermark 0. Current leader is 1. Previous leader epoch was 2. (state.change.logger)
[2022-12-17 19:59:51,639] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 5 for 1 partitions (state.change.logger)
[2022-12-17 19:59:51,639] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 9 for 2 partitions (state.change.logger)
[2022-12-17 19:59:51,659] INFO [Controller id=0 epoch=2] Partition library-events-0 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:51,660] INFO [Controller id=0 epoch=2] Partition library-events-2 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:51,660] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 2 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,660] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,660] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 2 partitions (state.change.logger)
[2022-12-17 19:59:51,660] INFO [Controller id=0 epoch=2] Sending StopReplica request for 2 replicas to broker 1 (state.change.logger)
[2022-12-17 19:59:51,661] INFO [Broker id=1] Finished LeaderAndIsr request in 151ms correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,661] INFO [Broker id=2] Finished LeaderAndIsr request in 150ms correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,664] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 10 (state.change.logger)
[2022-12-17 19:59:51,664] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 6 (state.change.logger)
[2022-12-17 19:59:51,665] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 19:59:51,665] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 19:59:51,665] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 19:59:51,665] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 19:59:51,666] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 19:59:51,666] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 19:59:51,666] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 19:59:51,666] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 4 from offset 0 with partition epoch 6 and high watermark 0. Current leader is 2. Previous leader epoch was 3. (state.change.logger)
[2022-12-17 19:59:51,666] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-12-17 19:59:51,667] INFO [Broker id=2] Leader library-events-1 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 4 from offset 0 with partition epoch 6, high watermark 0, ISR [2], adding replicas [] and removing replicas []. Previous leader epoch was 3. (state.change.logger)
[2022-12-17 19:59:51,667] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 11 for 1 partitions (state.change.logger)
[2022-12-17 19:59:51,667] INFO [Broker id=1] Finished LeaderAndIsr request in 1ms correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 19:59:51,669] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 12 (state.change.logger)
[2022-12-17 19:59:51,686] INFO [Broker id=2] Finished LeaderAndIsr request in 20ms correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2022-12-17 19:59:51,687] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 8 (state.change.logger)
[2022-12-17 19:59:51,688] INFO [Broker id=1] Handling StopReplica request correlationId 13 from controller 0 for 2 partitions (state.change.logger)
[2022-12-17 19:59:51,688] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 9 from controller 0 for 2 partitions (state.change.logger)
[2022-12-17 19:59:51,688] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 9 from controller 0 epoch 2 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-12-17 19:59:51,688] INFO [Broker id=2] Leader library-events-2 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 4 from offset 0 with partition epoch 6, high watermark 0, ISR [2], adding replicas [] and removing replicas []. Previous leader epoch was 3. (state.change.logger)
[2022-12-17 19:59:51,690] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 13 epoch 2 for partition library-events-2 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,706] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 13 epoch 2 for partition library-events-0 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,706] INFO [Broker id=2] Leader library-events-0 with topic id Some(O4Winmi9TcqxnAsgO1uHQg) starts at leader epoch 4 from offset 0 with partition epoch 6, high watermark 0, ISR [2], adding replicas [] and removing replicas []. Previous leader epoch was 3. (state.change.logger)
[2022-12-17 19:59:51,709] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 14 (state.change.logger)
[2022-12-17 19:59:51,724] INFO [Broker id=2] Finished LeaderAndIsr request in 36ms correlationId 9 from controller 0 for 2 partitions (state.change.logger)
[2022-12-17 19:59:51,725] INFO [Broker id=1] Handling StopReplica request correlationId 15 from controller 0 for 2 partitions (state.change.logger)
[2022-12-17 19:59:51,725] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 10 (state.change.logger)
[2022-12-17 19:59:51,742] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 15 epoch 2 for partition library-events-2 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,742] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 15 epoch 2 for partition library-events-0 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,960] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers Set(1, 2) for 0 partitions (state.change.logger)
[2022-12-17 19:59:51,972] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 2 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,973] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,973] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers Set(1, 2) for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,974] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,975] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,975] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 3 for partition library-events-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,975] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 4 from offset 0 with partition epoch 6 and high watermark 0. Current leader is 2. Previous leader epoch was 3. (state.change.logger)
[2022-12-17 19:59:51,975] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 3 for partition library-events-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,976] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 4 from offset 0 with partition epoch 6 and high watermark 0. Current leader is 2. Previous leader epoch was 3. (state.change.logger)
[2022-12-17 19:59:51,976] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 3 for partition library-events-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,976] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 3 for partition library-events-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,976] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 1 for 2 partitions (state.change.logger)
[2022-12-17 19:59:51,976] INFO [Broker id=2] Finished LeaderAndIsr request in 1ms correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,976] INFO [Broker id=1] Finished LeaderAndIsr request in 2ms correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,978] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 2 (state.change.logger)
[2022-12-17 19:59:51,978] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 2 (state.change.logger)
[2022-12-17 19:59:51,981] INFO [Controller id=1 epoch=3] Partition library-events-1 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:51,981] INFO [Controller id=1 epoch=3] Partition library-events-0 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:51,981] INFO [Controller id=1 epoch=3] Partition library-events-2 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:51,983] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 2 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,983] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-12-17 19:59:51,983] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers Set(1, 2) for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,984] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,984] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 3 for partition library-events-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,984] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 3 for partition library-events-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,984] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 3 for partition library-events-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,984] INFO [Broker id=1] Finished LeaderAndIsr request in 0ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,985] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,985] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 3 for partition library-events-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,985] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 3 for partition library-events-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,985] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 3 for partition library-events-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:51,985] INFO [Broker id=2] Finished LeaderAndIsr request in 0ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:51,986] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 4 (state.change.logger)
[2022-12-17 19:59:51,986] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 4 (state.change.logger)
[2022-12-17 19:59:56,618] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition library-events-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 19:59:56,618] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition library-events-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 19:59:56,618] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition library-events-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-12-17 19:59:56,619] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 19:59:56,619] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 19:59:56,647] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2022-12-17 19:59:56,647] INFO [Controller id=1 epoch=3] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2022-12-17 19:59:56,649] INFO [Broker id=1] Handling StopReplica request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,649] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 5 epoch 3 for partition library-events-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,649] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 5 epoch 3 for partition library-events-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,649] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 5 epoch 3 for partition library-events-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,651] INFO [Controller id=1 epoch=3] Partition library-events-1 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:56,651] INFO [Controller id=1 epoch=3] Partition library-events-0 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:56,652] INFO [Controller id=1 epoch=3] Partition library-events-2 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:56,652] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 2 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 19:59:56,652] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers Set(1, 2) for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,652] INFO [Controller id=1 epoch=3] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2022-12-17 19:59:56,653] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,653] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 6 (state.change.logger)
[2022-12-17 19:59:56,653] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 5 epoch 3 for partition library-events-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,653] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 5 epoch 3 for partition library-events-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,653] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 5 epoch 3 for partition library-events-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,654] INFO [Broker id=2] Finished LeaderAndIsr request in 1ms correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,654] INFO [Broker id=1] Handling StopReplica request correlationId 7 from controller 1 for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,654] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 7 epoch 3 for partition library-events-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,654] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 7 epoch 3 for partition library-events-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,654] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 7 epoch 3 for partition library-events-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,655] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 6 (state.change.logger)
[2022-12-17 19:59:56,893] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers Set(2) for 0 partitions (state.change.logger)
[2022-12-17 19:59:56,905] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 2 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 19:59:56,906] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers Set(2) for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,907] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,907] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 4 for partition library-events-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,907] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 4 for partition library-events-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,907] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 4 for partition library-events-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,907] INFO [Broker id=2] Finished LeaderAndIsr request in 0ms correlationId 1 from controller 2 for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,908] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 2 (state.change.logger)
[2022-12-17 19:59:56,911] INFO [Controller id=2 epoch=4] Partition library-events-1 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:56,911] INFO [Controller id=2 epoch=4] Partition library-events-0 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:56,912] INFO [Controller id=2 epoch=4] Partition library-events-2 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:56,914] INFO [Controller id=2 epoch=4] Partition library-events-1 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:56,914] INFO [Controller id=2 epoch=4] Partition library-events-0 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:56,914] INFO [Controller id=2 epoch=4] Partition library-events-2 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-12-17 19:59:56,914] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 2 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-12-17 19:59:56,915] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers Set(2) for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,915] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 2 for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,915] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 4 for partition library-events-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,915] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 4 for partition library-events-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,915] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 4 for partition library-events-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2022-12-17 19:59:56,915] INFO [Broker id=2] Finished LeaderAndIsr request in 0ms correlationId 3 from controller 2 for 3 partitions (state.change.logger)
[2022-12-17 19:59:56,916] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 4 (state.change.logger)
